---
metaTitle: 一次性密码字段
metaDescription: 一组单字符文本输入，用于处理一次性密码验证
name: 一次性密码字段
---

# 一次性密码字段

<Description>
	一组单字符文本输入，用于处理一次性密码验证。
</Description>

<HeroContainer>
	<OneTimePasswordFieldDemo />
</HeroContainer>

<HeroCodeBlock folder="OneTimePasswordField" />

<Highlights
	features={[
		"模仿单个输入字段的键盘导航",
		"粘贴时覆盖值",
		"密码管理器自动填充支持",
		"对数字和字母数字值的输入验证",
		"完成后自动提交",
		"隐藏输入以为表单数据提供单个值",
	]}
/>

## 结构

导入所有部分并将其组合在一起。

```jsx
import { unstable_OneTimePasswordField as OneTimePasswordField } from "radix-ui";

export default () => (
	<OneTimePasswordField.Root>
		{/* 每个字符一个输入 */}
		<OneTimePasswordField.Input />
		{/* 单个隐藏输入用于存储完整值 */}
		<OneTimePasswordField.HiddenInput />
	</OneTimePasswordField.Root>
);
```

## API 参考

### Root

包含一次性密码字段的所有部分。

<PropsTable
	data={[
		{
			name: "asChild",
			required: false,
			type: "boolean",
			default: "false",
			description: (
				<>
					更改作为子元素传递的默认呈现元素，合并它们的属性和行为。
					<br />
					<br />
					阅读我们的 <a href="../guides/composition">组合</a> 指南以获取更多细节。
				</>
			),
		},
		{
			name: "autoComplete",
			required: false,
			type: '"off" | "one-time-code"',
			typeSimple: "enum",
			default: "one-time-code",
			description: (
				<span>
					指定用户代理是否有权限提供自动填充表单字段值的帮助，并向浏览器提供有关字段中预期信息类型的指导。
				</span>
			),
		},
		{
			name: "autoFocus",
			required: false,
			type: "boolean",
			description: (
				<span>页面加载时，是否应该自动聚焦第一个可填充输入。</span>
			),
		},
		{
			name: "value",
			required: false,
			type: "string",
			description: (
				<span>
					字段的受控值。必须与 <Code>onValueChange</Code> 一起使用。
				</span>
			),
		},
		{
			name: "defaultValue",
			required: false,
			type: "string",
			description: (
				<span>
					字段初始呈现时的值。当不需要控制字段的状态时使用。
				</span>
			),
		},
		{
			name: "onValueChange",
			required: false,
			type: "(value: string) => void",
			typeSimple: "function",
			description: (
				<span>当字段的值发生变化时调用的事件处理程序。</span>
			),
		},
		{
			name: "autoSubmit",
			required: false,
			default: "false",
			type: "boolean",
			description: (
				<span>
					当所有字段均已填写时，组件是否应尝试自动提交。如果字段与 HTML <Code>form</Code> 元素关联，则将调用该表单的 <Code>requestSubmit</Code> 方法。
				</span>
			),
		},
		{
			name: "onAutoSubmit",
			required: false,
			type: "(value: string) => void",
			typeSimple: "function",
			description: (
				<span>
					当 <Code>autoSubmit</Code> 属性设置为 <Code>true</Code> 时，此回调将在尝试提交关联表单之前触发。无论是否找到表单，或提交是否被允许，它都会被调用。当 <Code>autoSubmit</Code> 设置为 <Code>false</Code> 时无操作。
				</span>
			),
		},
		{
			name: "disabled",
			required: false,
			type: "boolean",
			default: "false",
			description: (
				<span>输入元素是否被禁用。</span>
			),
		},
		{
			name: "dir",
			required: false,
			type: '"ltr" | "rtl"',
			typeSimple: "enum",
			default: '"ltr"',
			description:
				"在适用时字段的读取方向。如果省略，则假定为 LTR（从左到右）读取模式。",
		},
		{
			name: "orientation",
			required: false,
			type: '"horizontal" | "vertical"',
			typeSimple: "enum",
			default: '"vertical"',
			description: "输入元素的垂直方向。"
		},
		{
			name: "form",
			required: false,
			type: "string",
			description: (
				<span>
					指定与输入关联的 <Code>form</Code> 元素的字符串。该字符串的值（如果存在）必须与同一文档中 <Code>form</Code> 元素的 ID 匹配。
				</span>
			),
		},
		{
			name: "name",
			required: false,
			type: "string",
			description:
				"为输入控制指定的名称的字符串。此名称与控制的值一起提交当表单数据被提交时。",
		},
		{
			name: "placeholder",
			required: false,
			type: "string",
			description:
				"定义在控制没有值时在表单控制中显示的文本。为每个渲染的输入分割为单字符占位符。",
		},
		{
			name: "readOnly",
			required: false,
			type: "boolean",
			default: "false",
			description:
				"用户是否可以更新输入元素。",
		},
		{
			name: "sanitizeValue",
			required: false,
			type: "(value: string) => string",
			typeSimple: "function",
			description: (
				<span>
					当 <Code>validationType</Code> 设置为 <Code>"none"</Code> 时的自定义清理函数。此函数将在响应用户交互时更新值之前调用。
				</span>
			),
		},
		{
			name: "type",
			required: false,
			type: '"text" | "password"',
			typeSimple: "enum",
			default: '"text"',
			description: "字段输入元素的输入类型。",
		},
		{
			name: "validationType",
			required: false,
			type: '"none" | "numeric" | "alpha" | "alphanumeric"',
			typeSimple: "enum",
			default: '"numeric"',
			description: "指定要使用的输入验证类型。",
		},
	]}
/>

<DataAttributesTable
	data={[
		{
			attribute: "[data-orientation]",
			values: ["vertical", "horizontal"],
		},
	]}
/>

### Input

呈现一个文本输入，表示值中的单个字符。

<PropsTable
	data={[
		{
			name: "asChild",
			required: false,
			type: "boolean",
			default: "false",
			description: (
				<>
					更改作为子元素传递的默认呈现元素，合并它们的属性和行为。
					<br />
					<br />
					阅读我们的 <a href="../guides/composition">组合</a> 指南以获取更多细节。
				</>
			),
		},
	]}
/>

<DataAttributesTable
	data={[
		{
			attribute: "[data-index]",
			values:
				"与根字段值相对的字符索引对应的索引",
		},
	]}
/>

### HiddenInput

<PropsTable
	data={[
		{
			name: "asChild",
			required: false,
			type: "boolean",
			default: "false",
			description: (
				<>
					更改作为子元素传递的默认呈现元素，合并它们的属性和行为。
					<br />
					<br />
					阅读我们的 <a href="../guides/composition">组合</a> 指南以获取更多细节。
				</>
			),
		},
	]}
/>

## 示例

### 基本用法

```jsx
// 这将呈现一个包含 6 个输入的字段，用于 6 个字符的密码。
// 为每个字符的密码长度渲染一个 Input 组件。
<OneTimePasswordField.Root>
	<OneTimePasswordField.Input />
	<OneTimePasswordField.Input />
	<OneTimePasswordField.Input />
	<OneTimePasswordField.Input />
	<OneTimePasswordField.Input />
	<OneTimePasswordField.Input />
	<OneTimePasswordField.HiddenInput />
</OneTimePasswordField.Root>
```

### 分段控件

`Root` 组件接受任意子项，因此在输入之间渲染视觉分隔列表就像在输入之间渲染分隔符一样简单。我们建议使用 `aria-hidden` 隐藏装饰元素，以防辅助技术，并避免在 `Root` 中渲染其他有意义的内容，因为每个子元素预计都属于具有 `group` 角色的父元素。

```jsx line=3,5,7
<OneTimePasswordField.Root>
	<OneTimePasswordField.Input />
	<Separator.Root aria-hidden />
	<OneTimePasswordField.Input />
	<Separator.Root aria-hidden />
	<OneTimePasswordField.Input />
	<Separator.Root aria-hidden />
	<OneTimePasswordField.Input />
	<OneTimePasswordField.HiddenInput />
</OneTimePasswordField.Root>
```

### 输入密码时自动提交表单

使用 `autoSubmit` 属性，当所有输入都被填写时提交关联的表单。

```jsx
function Verify({ validCode }) {
	const PASSWORD_LENGTH = 6;
	function handleSubmit(event) {
		event.preventDefault();
		const formData = event.formData;
		if (formData.get("otp") === validCode) {
			redirect("/authenticated");
		} else {
			window.alert("无效的代码");
		}
	}
	return (
		<form onSubmit={handleSubmit}>
			<OneTimePasswordField.Root name="otp" autoSubmit>
				{PASSWORD_LENGTH.map((_, i) => (
					<OneTimePasswordField.Input key={i} />
				))}
				{/* HiddenInput 是必需的，以便表单具有与字段相关联的数据 */}
				<OneTimePasswordField.HiddenInput />
			</OneTimePasswordField.Root>
			<button>提交</button>
		</form>
	);
}
```

### 受控值

```jsx
function Verify({ validCode }) {
	const [value, setValue] = React.useState("");
	const PASSWORD_LENGTH = 6;
	function handleSubmit() {
		if (value === validCode) {
			redirect("/authenticated");
		} else {
			window.alert("无效的代码");
		}
	}
	return (
		<OneTimePasswordField.Root
			autoSubmit
			value={value}
			onAutoSubmit={handleSubmit}
			onValueChange={setValue}
		>
			{PASSWORD_LENGTH.map((_, i) => (
				<OneTimePasswordField.Input key={i} />
			))}
		</OneTimePasswordField.Root>
	);
}
```

## 可访问性

撰写本文时，WCAG 指南中没有实施一次性密码字段作为单独输入的单一确定的模式。该行为旨在尽可能接近使字段像单个输入一样运行，并根据我们最初的研究、测试和反馈收集进行了一些例外。

此组件作为具有 `group` 角色的容器内的 `input` 元素实现，以指示子输入相关联。可以使用方向键进行导航和聚焦，键入输入将移动焦点到下一个输入，直到到达最后一个输入。

将值粘贴到字段中将替换所有输入的内容，无论当前聚焦的输入是什么。根据我们的研究，这似乎与大多数用户期望相符，因为值通常是从密码管理器或电子邮件中粘贴过来的。

### 键盘交互

<KeyboardTable
	data={[
		{
			keys: ["Enter"],
			description: (
				<span>
					如果找到关联的 <Code>form</Code>，将尝试提交
				</span>
			),
		},
		{
			keys: ["Tab"],
			description: (
				<span>
					将焦点移动到 <Code>Root</Code> 外部的下一个可聚焦元素
				</span>
			),
		},
		{
			keys: ["Shift + Tab"],
			description: (
				<span>
					将焦点移动到 <Code>Root</Code> 外部的前一个可聚焦元素
				</span>
			),
		},
		{
			keys: ["ArrowDown"],
			description: (
				<span>
					当 <Code>orientation</Code> 为 <Code>vertical</Code> 时，将焦点移动到下一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["ArrowUp"],
			description: (
				<span>
					当 <Code>orientation</Code> 为 <Code>vertical</Code> 时，将焦点移动到前一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["ArrowRight"],
			description: (
				<span>
					当 <Code>orientation</Code> 为 <Code>horizontal</Code> 时，将焦点移动到下一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["ArrowLeft"],
			description: (
				<span>
					当 <Code>orientation</Code> 为 <Code>horizontal</Code> 时，将焦点移动到前一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["Home"],
			description: (
				<span>
					将焦点移动到第一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["End"],
			description: (
				<span>
					将焦点移动到最后一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["Delete"],
			description: (
				<span>
					删除当前聚焦的 <Code>Input</Code> 中的字符，并将以后的值向后移动
				</span>
			),
		},
		{
			keys: ["Backspace"],
			description: (
				<span>
					删除当前聚焦的 <Code>Input</Code> 中的字符，并将焦点移动到前一个 <Code>Input</Code>
				</span>
			),
		},
		{
			keys: ["Command + Backspace"],
			description: (
				<span>
					清除所有 <Code>Input</Code> 元素的值
				</span>
			),
		},
	]}
/>